### Process vs Thread

프로세스는 프로그램이 메모리에 올라와서 작업할 환경을 갖춘 걸 말하며 하나 이상의 스레드를 가진다. 

스레드는 프로세스의 실행 단위라고 할 수 있다. 

프로세스는 운영체제로부터 시스템 자원을 할당 받는데 여기에는 Code, Data, Stack, Heap 이라는 메모리 공간을 받는다.

- Code: 작성한 코드가 들어가는 부분이다. Read-Only 로 쓰기 작업이 들어올 수 없다.

- Data: 전역변수, 정적변수 등이 저장되는 곳

- Heap: 프로그래머가 동적으로 사용하는 공간을 말한다.

- Stack: 지역변수 매개변수 함수가 종료된 후 돌아갈 곳 등이 저장되는 임시 메모리이다. 

#### 프로세스 제어 블록 PCB

특정 프로세스에 대한 정보를 저장하고 있는 커널 내에서 관리하자료구조다. 

OS 는 PCB 를 통해 프로세스를 직접 관리한다. 

컨택스트 스위칭에서 현재의 프로세스 실행 흐름을 PCB 에 저장하고 전환하고 다시 자신이 실행할 수 있는 환경이라면 PCB 에 있던 내용을 불러와서 실행한다.

PCB 에 저장되는 정보로는 다음과 같다.

- PID: 프로세스 식별 ID

- 프로세스 상태: new, ready, running, waiting 과 같은 정보를 말한다. 

- 프로그램 카운터: 프로세스가 다음 실행할 명령어의 주소를 말한다. 

- 레지스터 정보

- 스케쥴링 정보: 프로세스 우선순위 등을 말한다. 

- 메모리 관련 정보: 페이지 테이블 또는 세그먼트 테이블 과같은정볼를 말한다. 

- 어카운트 정보: 사용된 CPU 시간, 시간 제한, 계정 번호 등을말한다.


#### 멀티 프로세스 vs 멀티스레드

멀티 프로세스의 장점으로는 여러개의 자식 스레드를 기반으로 움직이기 떄문에 하나의 프로세스가 죽어도 다른 프로세스에 영향이 없다.

안정성 면에서 더 높지만 컨택스트 스위칭 비용이 멀티 스레드 보다 크다. 프로세스 끼리는 공유되는 부분이 없기 때문에 그리고 캐시 메모리 초기화 등의

무거운 작업이 진행되기 떄문에 비용이 크다.

멀티 스래드는 멀티 프로세스보다 안정성은 떨어지지만 컨택스트 스위칭이 더 빠르기 때문에 더 빠르다. 하지만 공유되는 영역을 사용하기 떄문에 동시성 관련한 문제를 잘 알고 있어야 한다. 


#### Context Switching 이란

CPU 코어당 하나의 Task 를 처리할 수 있는데 여러가지 Task 들을 돌아가면서 처리하기 위해서는 현재 처리하고 있는 것들을 

기록해놓고 나중에 다시 처리할때 불러와서 진행해야 한다. 이를 Context Switching 이라고 한다.  

스택 포인터나 프로그램 카운터, 레지스터 정보등을 저장해놓고 다시 불러와서 쓴다. 

Context Switching 에서 하는 비용은 다음과 같다. 

- Cache 초기화

- Memory Mapping 초기화

#### Thread-Safe 란? 

멀티 스레드 환경에서 내 예상대로 제대로 동작하는 지를 말한다.  

Thread-Safe 하게 구현하기 위해서는 공유 자원에 접근하는 임계 영역을 동기화 할 기법이 있어야 한다. 


