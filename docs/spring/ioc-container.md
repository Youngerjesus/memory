## IoC Container 

객체를 생성해주고 의존관계를 엮어주는 컨테이너

@ComponentScan 으로 내가 만든 객체를 빈으로 등록해주고

@EnableAutoConfiguration 으로 라이브러리들을 빈으로 등록해준다. 

#### IoC (Inversion of Control) 제어의 역전

내가 의존성들을 연결 시켜주는게 아니라 스프링 같은 프레임워크 단에서 연결 시켜주는 걸 말한다. 

IoC 를 함으로써 객체는 의존성 연결에는 신경쓰지 않아도 되고 자신이 수행해야 할 로직에만 집중하면 된다. 

프로그램의 제어의 흐름, 의존성의 연결을 시켠쓰지 않아도 된다. 

#### 프레임워크와 라이브러리

내가 코드를 가지고와서 사용햐는 건 라이브러리. 

내 코드를 다루는 역할을 하는게 프레임 워크

#### DI 의 좋은점 

객체지향 프로그래밍에서 신경써야 할 요소가 SOLID 라는 원칙이 있다.

DI 를 하면 여기에 있는 원칙들을 기준으로 더 나은점을 제공해준다.

SRP - 단일 책임의 원칙

- 객체 생성의 책임을 지지 않아도 된다. 자신이 실행하는 로직에만 신경쓰면 된다.

OCP - 개방 폐쇄 원칙

- 역할에 의존하도록 인터페이스에 의존하도록 하고 실제 구현 객체에 의존하지 않아도 된다. 
구현 객체가 개선되던지 바뀌던지 신경쓰지 않아도 된다. 변경에 닫혀있다. 

DIP 

- 마찬가지로 인터페이스에 의존하도록 할 수 있다. 

#### ApplicationContext 와 BeanFactory

BeanFactory 가 스프링 컨테이너의 최상위 인터페이스로 빈을 관리하고 등록하는 역할을 한다.

ApplicationContext 는 빈 팩토리 이외에도 부가적인 기능을 좀 더 한다. 메시지 국제화, 환경 변수를 관리하는 것, 애플리케이션 이벤틀르 발행하고 구독하는 것, 클래스 패스나 외부에서 리소스를 편리하게 조회하도록 하는 것

#### 스프링 빈 등록방법 

스프링에서는 빈을 등록할 때 XML 형식이나 자바 코드로 등록할 수 있다. 이처럼 다양하게 등록할 수 있는 이유는 역할과 구현을 구분했기 때문에.

결국에는 BeanDefinition 이라는 역할에 의존한 정보만 가져오면 된다. BeanDefinition 이란 빈을 등록하기 위한 정보들을 가지고 있다. 이를 바탕으로 빈으로 등록한다.

BeanDefinition 정보

- BeanClassName : 생성할 빈의 클래스 이름

- factoryBeanName: 팩토리 역할을 하는 빈의 이름 (Configuration File 같은 걸 말한다.)

- factoryMethodName : 팩토리 역할을 하는 빈에서 빈으로 등록해주는 메소드 이름

- Scope: 스코프 (싱글톤의 기본이고 매번 다른 객체가 생성되는 프로토 타입이 있다.)

- LazyInit : 스프링 컨테이너를 생성할 때 빈을 생성하는게 아니라 실제 사용할 때 빈으로 등록할지의 여부를 말한다. 

- DestroyMethodName: 빈의 생명주기 메소드로 빈이 죽을때 실행할 메소드 이름 

- Constructor arguments : 의존관계 주입에서 사용되는 매개변수들을 말한다. 


#### 왜 빈을 싱글톤으로 하는 것일까? 

매 번 사용자의 요청마다 인스턴스를 생성한다고 생각하면 메모리 사용량이 커진다. 

반복되고 상태가 필요없는 객체라면 재사용하는게 효율적이기 때문에 싱글톤으롯 사용한다.  

#### 그렇다면 싱글톤의 단점은 뭘까? 

싱글톤으로 만드는 방법은 다양하고 만들기 위해서 사용하는 코드가 있다. 코드의 반복되는 작업을 해줘야 한다는 점이고

싱글톤으로 만들때 결국엔 실제 구현 객체를 넣어줘야 하는데 그러면 DIP 나 OCP 를 위반할 수 있다. 

#### 싱글톤으로 만들 때 주의할 점

객체를 외부에서 생성하지 못하도록 할 것. 상태에 의존하지 않도록 할 것.


#### 스프링에선 싱글톤으로 보장하기 위해서 어떻게 할까? 

@Configuration 파일을 이용해서 빈으로 등록하는데 이떄 new 키워드를 통해서 객체를 생성해준다. 이는 싱글톤이 아니다. 어떻게 그러면 싱글톤으로 만드는가? 

- CGLIB 라는 바이트코드 조작 라이브러리를 이용해서 싱글톤으로 만들어준다. 

#### @ComponentScan

@Component 에노테이션이 붙은 클래스를 스프링 빈으로 등록해준다. 그리고 @ComponentScan 이 붙은 클래스를 기준으로 하위 패키지까지 모두 조사해준다. 

패키지를 조사해줄때 필터를 이용해서 컴포넌트 스캔 대상을 추가해주거나 제외 해주는게 가능하다.  

이때 등록해주는 빈의 이름은 직접 지정한 경우에는 그걸 쓰지만 그렇게 하지 않았다면 첫글자는 소문자로 지정해서 등록해준다. 

빈의 조회 전략은 타입을 기반으로 조회한다. 

