## Microserivce Architecture

***

### Q. 마이크로서비스에서 데이터 관리

각각의 마이크로서비스마다 분리된 저장소를 갖게된다. 이 경우 비즈니스에서 데이터의 정합성이 안맞는 경우가 생길 수 있다. 

물론 이를 위해서 2단계 커밋과 같은 기법을 사용할 수도 있지만 이런 기능을 NoSQL 에서는 지원 안하는 경우가 있다. 

분산 트랜잭션 Saga 패턴을 이용해서 데이터의 일관성(정합성) 을 맞출 수 있다. 각각의 서비스에서 로컬 트랜잭션을 실행하고 무슨 문제가 생기는 부분에 대해서 보상 트랜잭션을 실행하도록 하는 기법이다. 

즉 여러 트랜잭션을 하나로 묶지 말고 별도의 트랜잭션을 실행시키는 기법  

### Q. 실패를 고려한 설계는 어떻게 했는가? 

소프트웨어는 실패가 안되도록 추구하면 안되고 실패가 나면 어떻게 대응할 것인가가 중요하다. 

이를 위해 컨테이너 오케스트레이션 프레임워크인 쿠버네티스를 이용하도록 했고 무중단으로 실행하기 위해서 카나리 배포 전략을 기반으로 했다. 

### Q. 마이크로서비스 설계를 어떻게 했는가?
 
### Q. Pod 의 로그 확인은 어떻게 하는가 

Isito 에서 fluentd 를 이용해 외부 Object Storage 에 전송하는 방법을 통해서 로그 중앙화를 구성했다. 


### Q. 서비스 디스커버리 패턴은 어떻게 되는가? 

마이크로 서비스 구조에서는 여러가지 서비스가 있는 경우가 많은데 처음에 서비스 요청을 받는 진입점인 API Gateway 에서 클라이언트에서

요청한 서비스를 호출할 때나 서비스끼리 필요한 서비스를 호출할 때 서비스 디스커버리 패턴을 사용한다. 

쿠버네티스 기준으로 서비스는 매번 IP 가 달라질 수 있다. 그래서 이런 바뀌는 IP 들을 따로 관리해주는 제3의 무엇인가가 있어야 하는데 

이게 쿠버네티스 서비스 리소스다. 

쿠버네티스의 서비스 같은 경우 셀렉터를 기준으로 묶인 Pod 들을 관리해주는 역할을 한다. 

### Q. 서비스 단일 진입을 위한 API Gateway 패턴

서비스 요청을 받는 지점을 단일 지점으로 즉 API Gateway 로 받는 걸 통해서 로드밸런싱 적용이나 인증 및 인가 적용을 할 수 있다.

### Q. 다양한 클라이언트를 위한 BFF 패턴

각 클라이언트에 따라 최적화된 처리를 할 수 있도록 하는 BFF 패턴 


### Q. 마이크로서비스 설계는 어떻게 했는가? 

마이크로서비스 아키텍처를 이루는 여러가지 패턴이 있는걸로 리서치를 했었다.

 