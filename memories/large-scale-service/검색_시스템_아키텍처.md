# 검색 시스템 아키텍처

### 검색 시스템이 완성되기 까지.

1. 크롤링
2. 저장
3. 인덱싱
4. 검색 
5. 스코어링
6. 결과표시
- 크롤링은 대량의 데이터를 가지고 오는 과정을 말하는 것이고
- 저장은 데이터를 데이터베이스에 저장하는 과정을 말한다. 하나의 데이터베이스에만 넣으면 데이터베이스가 깨질 때 문제가 생길 수 있으므로 분산 데이터베이스에 넣는 걸 생각해야한다.
- 인덱싱은 데이터를 고속으로 조회하기 위한 과정이다.
- 스코어링은 검색 결과를 랭킹을 매겨서 사용자가 좋아할 만한 순서대로 정렬하는 것이다.
- 스코어링과 결과 표시에 대해서 궁금하다면 스탠포드 교재인 Information Retrieval 을 읽어보자.

### 전문 검색의 종류

- 전문 검색에는 grep 형, Suffix 형, Inverted Index 형이 있다.
- grep 형은 문서를 처음부터 순서대로 하나씩 빠짐없이 읽는 방법이다.
    - 성능은 좋지 않지만 누락이 없다는 장점이 있다.
    - 최신의 데이터도 조회하는데 문제가 없다.
    - 가장 나이브하게 한다면 본문의 길이 m, 검색어의 길이 n 이라고 하면 O(mn) 이 될 것이다.
    - 물론 KMP 나 Boyer-moore 알고리즘을 사용한다면 더 효율이 좋을 수 있다.
        - KMP = O(m+n)
        - Boyer-moore = best O(m/n), worst O(mn)
    - grep 도 병렬화해서 성능을 높일 수 있다. 매우 긴 문자열을 나눠서 읽는다던지,
- Suffix 형은 검색 대상 전문을 검색이 가능한 형태로 가지고 있는 것이다.
    - 데이터 구조로는 Trie, Suffix Array, Suffix Tree 가 있다.
    - 간단하게만 말하면 문서를 전체 메모리에 올려서 검색이 가능한 형태로 가지고 있는 것이다.
    - 역인덱스는 문서를 메모리에 모두 올리고 있지는 않는다.
    - PFI 의 Sedue 는 Suffix Array 를 엄청나게 압축해서 이를 활용하기도 했다. 이 자료구조를 Compressed Suffix Array 라고 부르기도 한다.
    - FM-index 라고 Block Sorting 으로 텍스트를 압축하는 비슷한 기법이 있다고도 한다.
- 역인덱스형
    - 단어-문서를 연관시켜서 찾는 것.
    - 역인덱스를 문서와 관계없이 전처리로 만들어야 한다는 단점이 있다. 그래서 문서의 변화에 바로 대응하기가 어렵다.
    - 또 구현 방법에 따라서 검색 누락이 발생할 수도 있다.
    - 이렇게 말하면 단점 투성이지만 역인덱스의 자료구조는 되게 컴팩트하다. Suffix 형과 비교해보면 그래서 대규모로 사용하기가 좋다.