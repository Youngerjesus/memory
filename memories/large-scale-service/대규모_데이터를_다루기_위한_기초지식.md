# 대규모 데이터를 다루기 위한 기초지식

대규모 데이터를 다룰 때 생각해야 할 지식은 대표적으로 두 가지가 있다.

- I/O 연산을 줄이도록
    - Page Cache 를 잘 사용하는 것.
        - 캐시를 잘 유지하고 서버가 여러대인 경우 캐시가 겹치는 문제를 줄여보는 것.
        - 파티셔닝을 잘 하면됨.
        - 도메인끼리 DB 를 나누는 것이 기본적이 되야할 듯. (캐시를 겹치지 않기 위해서는)
    - Search Engine 을 잘 사용하는 것. 인덱스를 잘 사용하는 것.
        - 필요한 데이터를 디스크에서 가져올 때 대량의 데이터에 접근하지 않는 것.
    - 데이터 압축 알고리즘을 사용하는 것.
        - 필요한 데이터를 메모리에 모두 올리는 방법도 괜찮을 수 있다.
            - 메모리가 그렇게 비싼건 아니다. 압축알고리즘을 개발하는 것보다 이게 더 쌀 수 있다. (늘 내가 하는 작업이 얼마짜리 작업인지 생각해보자.)
            - 대신에 어플리케이션이 시작할 때 캐시에 데이터를 로드하는 작업을 해야한다. 필수.
- 알고리즘을 개선하는 것.

### CPU 병목과 I/O 병목 해결하기

- `sar` 을 실행하면 CPU 사용량과 I/O 사용량이 얼마인지 볼 수 있다.
    - `%user` 에 있는 지표는 사용자 영역에 있는 프로세서가 차지하고 있는 CPU 사용량.
    - `%iowait` 에 있는 지표가 I/O 를 기다리는 프로세스 비율이다.
        - 이 지표가 20%만 되더라도 많은 비율이다. 1% 내로 있는게 이상적으로 응답속도를 낼 수 있다.
- `sar -P ALL` 명령을 하면 CPU 코어별로 사용량을 볼 수 있다.