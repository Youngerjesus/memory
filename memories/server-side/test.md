## 테스트

소프트웨어는 프로그래밍 언어만 알고 개발환경만 갖추면 누구나 개발하는게 가능하다. 

하지만 그렇게 만든 소프트웨어가 제대로 동작하는지, 성능이 나오는지, 안정성이나 확장성이 충분한지 등은 증명할 수 없다.

이는 테스트를 통해서 검증하는게 가능한데 전통적인 소프트웨어는 출시 전에만 테스트를 통해서 검증했다. 하지만 이는 비용이 큰데
왜냐하면 소프트웨어는 초기에 발견해서 수정하는게 비용이 저렴하기 때문이다.

여기서 소개하는 방법은 엔터프라이즈 환경에서의 개발이지만 일반적인 소프트웨어 개발에서도 사용하는 테스트방법이다.

#### V 모델

여기서 설명하는 테스트 모델은 V 모델 이라는 방법을 이용한다.

이는 시스템의 개발 단계를 4단계로 구분시켜놓고 이에 맞는 테스트 기법을 사용하는 걸 말한다.

모델은 다음과 같다.

- Validation (정적 테스트)

  - Validation 은 정적 테스트로 주로 올바른 제품을 만들고 있는가 에 대한 테스트로 고객의 요구사항을 제대로 만족하고 있는지에 대한 테스트다.
  
  - 주로 소스 코드나 요구사항 명세서 같은 문서를 기반으로 테스트된다.
  
  - 과정은 다음과 같다.  
  
      - 분석 
      
      - 설계
      
      - 상세 설계
      
      - 구현
  
- Verification (동적 테스트)

  - Verification 은 동적 테스트로 시스템의 동작이 제대로 되고 있는지에 대한 테스트다.
  
  - 과정은 다음과 같다. 
  
      - 분석 (인수 테스트)
     
      - 설계 (시스템 테스트)
     
      - 상세 설계 (통합 테스트)
     
      - 구현 (단위 테스트)
      
#### 정적 테스트

정적 테스트는 코드 리뷰 방식과 자동화된 도구를 이용한 정적 분석 툴을 이용한 방식 이렇게 있다.

정적 분석 툴은 주로 다음과 같은 작업들을 수행한다.

- 잘 알려진 버그 리포팅

- 표준에 맞지 않는 코딩 내용 찾아내기 (띄어쓰기, 줄 바꾸기, 변수명 등등)

- 실행되지 않는 데드코드 찾기

- 코드의 복잡도를 계산

#### 동적 테스트

동적 테스트는 단위 테스트, 통합 테스트, 시스템 테스트, 인수 테스트 이렇게 있다. 

하나하나씩 살펴보자.

- 단위 테스트

  - 개발자가 주도로 하는 테스트이며 소스 코드의 로직이 제대로 동작하는지 검증을 목표로 하는 테스트다.
  
  - 자신이 작성한 클래스나 메소드가 제대로 동작하는지 검증하는 목적으로 사용된다.
  
  - 주로 독립된 하나의 컴포넌트를 테스트 하는 목적으로 사용되므로 다른 컴포넌트의 의존성이 필요하다면 모킹(mocking) 을 통해서 주로 해결한다. 

- 통합 테스트

  - 컴포넌트끼리 상호 연계가 잘 되는지를 목표로 하는 테스트다.
  
  - 시스템의 기능적인 면을 우선으로 보고 비기능적인 면까지 보지는 않는다.

- 시스템 테스트

  - 비기능 종류(안정성이나 확장성, 장애, 그리고 성능)을 위주로 테스트한다.
  
  - 성능 테스트
  
      - 성능 테스트에서 중요한 건 TPS 와 응답 시간이다. 일반적으로 클라우드 환경에서는 수평적으로 인스턴스를 확보할 수 있으므로
      인스턴스를 늘렸을때 선형적으로 처리량이 올라가는지를 위주로 테스트한다. 
      
        - 성능 테스트에서 하나의 인스턴스가 낼 수 있는 임계치의 성능을 결정하는 용도로 주로 쓰이며 어느 시점 이후에 TPS 가 올라가지 않는 지점이 있고
        이게 임계점이다. 
        
        - 응답 시간이 중요한 경우에는 목표로 한 응답 시간이 부하가 얼마일때 도달하는지를 체크하는 용도로 쓰인다. 
        
        - 일반적으로 성능 테스트 때 CPU 나 메모리 같은 하드웨어를 기준으로 성능 테스트를 할 때 CPU 는 최대 70 ~ 80% 기준으로
        잡는다. 
       
  - 장애 테스트 
 
       - 장애 테스트는 시스템이 장애가 났을 때 이를 탐지하고 복구하는 능력이 있는지 검사하는 테스트다.
       
       - 시스템이 장애가 나고 이를 복구하는 페일 오버가 제대로 동작하는지 그리고 이후에 정상적으로 요청을 처리할 수 있는지를 검사한다고 보면 된다.
       
       - 장애 테스트는 강제로 장애를 만드는 걸로 부터 시작된다. 
       
       - 장애의 유형은 다양하지만 대표적으로는 다음과 같다.
       
         - 미들웨어 장애 테스트
         
           - DBMS, WAS 같은 미들웨어가 장애가 났을 때 대응능력을 검증하는 테스트다.
           
         - 하드웨어 장애 테스트
         
           - 다음으로 하드웨어에 대한 장애 테스트가 있는데 하드웨어가 장애 났을 때 대처 능력을 기준으로 검증한다.
           
           - 해당 하드웨어의 전원을 갑자기 끄거나 하는 식으로 장애를 일으킨다. 
           
         - 네트워크 장애 테스트
         
           - 네트워크 연결 장애를 기반으로 장애를 일으켜서 검증하는 테스트다. 

  - 안정성 테스트
  
    - 안정성 테스트는 시스템을 몇일동안 운영해보면서 장애가 나지 않는지를 검사하는 테스트다.
    
    - 주로 부하를 주면서 모니터링 하는데 여기서 메모리 누수같은 것이 생기지 않는지 검사하는 테스트다.
    
  - 확장성 테스트
  
    - 확장성 테스트는 시스템이 증설하면서 선형적으로 처리량이 증가하는지를 테스트하는 것이다.
    
    - 확장성은 크게 수직적 확장성과 수평적 확장성이 있는데 수직적은 시스템의 스펙을 올려가면서 성능을 올리는 기법이라면 수평적 확장성은 서버 인스턴스를 늘려나가면서 확장하는 기법이다.
    
    - 수평적 확장성의 테스트는 서버의 인스턴스를 늘리면 처리할 수 있는 용량도 함께 증가하는지를 보기 위한 테스트다.
    

- 단일 거래 테스트와 복합 거래 테스트

    - 단일 거래 테스트는 하나의 시나리오를 기반으로 테스트 하는 기법이라면 복힙 테스트는 실 운영에 맞는 시나리오 기반으로 테스트 하는 방법이다.
    
    - 복합 거래 테스트로 실제 이 서버의 용량이 결정된다.
  

- 화이트 박스 테스트와 블랙 박스 테스트

  - 화이트 박스 테스트는 내부의 구조를 알고 있다는 전제 하에 실행이 되는 테스트라면 블랙 테스트는 그런거 모르고 서버가 수행할 수 있는 능력을
  테스트 하는 걸 말한다.
  

- 인수 테스트
 
  - 인수 테스트는 실제 출시를 할 지 말 지를 결정하는 테스트다. 주로 사용자 경험 측면을 테스트 하는 용도로 쓰인다.
  
  - 인수 테스트를 기점으로 좀 더 보강해서 출시 할 지를 결정한다고 보면 된다.   


